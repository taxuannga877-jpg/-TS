================================================================================
化学反应过渡态结构预测 - 训练日志
================================================================================

📊 训练配置
--------------------------------------------------------------------------------
模型: Transformer-based TSPredictor
训练集: 9,065 个反应
验证集: 1,008 个反应
Batch Size: 16
Learning Rate: 1e-4
优化器: AdamW (weight_decay=1e-5)
学习率调度: CosineAnnealingLR
损失函数: MSE

================================================================================

📈 训练过程 (Epoch by Epoch)
================================================================================

────────────────────────────────────────────────────────────────────────────────
Epoch 1/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.075831
  验证损失 (Loss/val):          0.071544
  训练RMSD (Å):                 0.4114
  验证RMSD (Å):                 0.3993  
  成功率 (RMSD<0.5Å):           73.61%
  学习率:                       9.99e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 2/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.072185
  验证损失 (Loss/val):          0.070581
  训练RMSD (Å):                 0.4015
  验证RMSD (Å):                 0.3950  
  成功率 (RMSD<0.5Å):           74.40%
  学习率:                       9.96e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 3/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.069910
  验证损失 (Loss/val):          0.067830
  训练RMSD (Å):                 0.3949
  验证RMSD (Å):                 0.3848  
  成功率 (RMSD<0.5Å):           76.69%
  学习率:                       9.91e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 4/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.066139
  验证损失 (Loss/val):          0.064355
  训练RMSD (Å):                 0.3823
  验证RMSD (Å):                 0.3735  ⭐ 最佳
  成功率 (RMSD<0.5Å):           77.28%
  学习率:                       9.84e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 5/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.063093
  验证损失 (Loss/val):          0.062567
  训练RMSD (Å):                 0.3719
  验证RMSD (Å):                 0.3682  
  成功率 (RMSD<0.5Å):           78.47%
  学习率:                       9.76e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 6/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.061287
  验证损失 (Loss/val):          0.063097
  训练RMSD (Å):                 0.3655
  验证RMSD (Å):                 0.3693  
  成功率 (RMSD<0.5Å):           78.67%
  学习率:                       9.65e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 7/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.059685
  验证损失 (Loss/val):          0.060054
  训练RMSD (Å):                 0.3602
  验证RMSD (Å):                 0.3571  
  成功率 (RMSD<0.5Å):           79.56%
  学习率:                       9.52e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 8/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.058361
  验证损失 (Loss/val):          0.059289
  训练RMSD (Å):                 0.3560
  验证RMSD (Å):                 0.3581  ⭐ 最佳
  成功率 (RMSD<0.5Å):           80.46%
  学习率:                       9.38e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 9/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.057085
  验证损失 (Loss/val):          0.059311
  训练RMSD (Å):                 0.3515
  验证RMSD (Å):                 0.3561  
  成功率 (RMSD<0.5Å):           80.56%
  学习率:                       9.22e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 10/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.055897
  验证损失 (Loss/val):          0.058300
  训练RMSD (Å):                 0.3477
  验证RMSD (Å):                 0.3518  
  成功率 (RMSD<0.5Å):           80.26%
  学习率:                       9.05e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 11/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.054129
  验证损失 (Loss/val):          0.057644
  训练RMSD (Å):                 0.3422
  验证RMSD (Å):                 0.3479  
  成功率 (RMSD<0.5Å):           81.65%
  学习率:                       8.85e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 12/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.053015
  验证损失 (Loss/val):          0.057639
  训练RMSD (Å):                 0.3382
  验证RMSD (Å):                 0.3476  
  成功率 (RMSD<0.5Å):           81.25%
  学习率:                       8.64e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 13/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.051818
  验证损失 (Loss/val):          0.056530
  训练RMSD (Å):                 0.3341
  验证RMSD (Å):                 0.3448  
  成功率 (RMSD<0.5Å):           83.23%
  学习率:                       8.42e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 14/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.050179
  验证损失 (Loss/val):          0.056962
  训练RMSD (Å):                 0.3286
  验证RMSD (Å):                 0.3447  ⭐ 最佳
  成功率 (RMSD<0.5Å):           82.34%
  学习率:                       8.19e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 15/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.048793
  验证损失 (Loss/val):          0.055853
  训练RMSD (Å):                 0.3243
  验证RMSD (Å):                 0.3419  
  成功率 (RMSD<0.5Å):           82.64%
  学习率:                       7.94e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 16/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.047148
  验证损失 (Loss/val):          0.055422
  训练RMSD (Å):                 0.3188
  验证RMSD (Å):                 0.3387  
  成功率 (RMSD<0.5Å):           82.74%
  学习率:                       7.68e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 17/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.045699
  验证损失 (Loss/val):          0.055545
  训练RMSD (Å):                 0.3139
  验证RMSD (Å):                 0.3380  
  成功率 (RMSD<0.5Å):           82.74%
  学习率:                       7.41e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 18/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.043866
  验证损失 (Loss/val):          0.055157
  训练RMSD (Å):                 0.3075
  验证RMSD (Å):                 0.3367  
  成功率 (RMSD<0.5Å):           83.23%
  学习率:                       7.13e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 19/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.042366
  验证损失 (Loss/val):          0.056033
  训练RMSD (Å):                 0.3022
  验证RMSD (Å):                 0.3384  
  成功率 (RMSD<0.5Å):           82.44%
  学习率:                       6.84e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 20/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.040869
  验证损失 (Loss/val):          0.055930
  训练RMSD (Å):                 0.2967
  验证RMSD (Å):                 0.3376  
  成功率 (RMSD<0.5Å):           83.04%
  学习率:                       6.55e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 21/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.039236
  验证损失 (Loss/val):          0.056349
  训练RMSD (Å):                 0.2911
  验证RMSD (Å):                 0.3382  
  成功率 (RMSD<0.5Å):           82.74%
  学习率:                       6.24e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 22/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.037769
  验证损失 (Loss/val):          0.056899
  训练RMSD (Å):                 0.2851
  验证RMSD (Å):                 0.3390  ⭐ 最佳
  成功率 (RMSD<0.5Å):           82.64%
  学习率:                       5.94e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 23/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.036329
  验证损失 (Loss/val):          0.055528
  训练RMSD (Å):                 0.2800
  验证RMSD (Å):                 0.3359  
  成功率 (RMSD<0.5Å):           82.94%
  学习率:                       5.63e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 24/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.034948
  验证损失 (Loss/val):          0.056042
  训练RMSD (Å):                 0.2748
  验证RMSD (Å):                 0.3355  
  成功率 (RMSD<0.5Å):           83.33%
  学习率:                       5.31e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 25/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.033666
  验证损失 (Loss/val):          0.056728
  训练RMSD (Å):                 0.2700
  验证RMSD (Å):                 0.3357  
  成功率 (RMSD<0.5Å):           82.94%
  学习率:                       5.00e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 26/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.032405
  验证损失 (Loss/val):          0.056569
  训练RMSD (Å):                 0.2648
  验证RMSD (Å):                 0.3363  
  成功率 (RMSD<0.5Å):           82.94%
  学习率:                       4.69e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 27/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.031252
  验证损失 (Loss/val):          0.056224
  训练RMSD (Å):                 0.2602
  验证RMSD (Å):                 0.3343  
  成功率 (RMSD<0.5Å):           82.84%
  学习率:                       4.37e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 28/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.030065
  验证损失 (Loss/val):          0.056188
  训练RMSD (Å):                 0.2554
  验证RMSD (Å):                 0.3347  ⭐ 最佳
  成功率 (RMSD<0.5Å):           83.83%
  学习率:                       4.06e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 29/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.029059
  验证损失 (Loss/val):          0.055874
  训练RMSD (Å):                 0.2513
  验证RMSD (Å):                 0.3333  
  成功率 (RMSD<0.5Å):           83.43%
  学习率:                       3.76e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 30/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.028184
  验证损失 (Loss/val):          0.057526
  训练RMSD (Å):                 0.2474
  验证RMSD (Å):                 0.3373  
  成功率 (RMSD<0.5Å):           83.04%
  学习率:                       3.45e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 31/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.027200
  验证损失 (Loss/val):          0.056363
  训练RMSD (Å):                 0.2435
  验证RMSD (Å):                 0.3341  
  成功率 (RMSD<0.5Å):           83.43%
  学习率:                       3.16e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 32/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.026264
  验证损失 (Loss/val):          0.057348
  训练RMSD (Å):                 0.2393
  验证RMSD (Å):                 0.3366  
  成功率 (RMSD<0.5Å):           82.84%
  学习率:                       2.87e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 33/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.025604
  验证损失 (Loss/val):          0.057243
  训练RMSD (Å):                 0.2363
  验证RMSD (Å):                 0.3358  
  成功率 (RMSD<0.5Å):           83.23%
  学习率:                       2.59e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 34/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.024850
  验证损失 (Loss/val):          0.057965
  训练RMSD (Å):                 0.2333
  验证RMSD (Å):                 0.3370  
  成功率 (RMSD<0.5Å):           82.64%
  学习率:                       2.32e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 35/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.024154
  验证损失 (Loss/val):          0.057107
  训练RMSD (Å):                 0.2300
  验证RMSD (Å):                 0.3359  ⭐ 最佳
  成功率 (RMSD<0.5Å):           83.23%
  学习率:                       2.06e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 36/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.023552
  验证损失 (Loss/val):          0.057835
  训练RMSD (Å):                 0.2273
  验证RMSD (Å):                 0.3378  
  成功率 (RMSD<0.5Å):           83.04%
  学习率:                       1.81e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 37/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.023056
  验证损失 (Loss/val):          0.056605
  训练RMSD (Å):                 0.2246
  验证RMSD (Å):                 0.3343  
  成功率 (RMSD<0.5Å):           82.94%
  学习率:                       1.58e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 38/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.022647
  验证损失 (Loss/val):          0.057256
  训练RMSD (Å):                 0.2231
  验证RMSD (Å):                 0.3355  
  成功率 (RMSD<0.5Å):           82.84%
  学习率:                       1.36e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 39/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.022075
  验证损失 (Loss/val):          0.056861
  训练RMSD (Å):                 0.2203
  验证RMSD (Å):                 0.3341  
  成功率 (RMSD<0.5Å):           83.33%
  学习率:                       1.15e-05

────────────────────────────────────────────────────────────────────────────────
Epoch 40/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.021764
  验证损失 (Loss/val):          0.056536
  训练RMSD (Å):                 0.2188
  验证RMSD (Å):                 0.3339  
  成功率 (RMSD<0.5Å):           82.84%
  学习率:                       9.55e-06

────────────────────────────────────────────────────────────────────────────────
Epoch 41/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.021412
  验证损失 (Loss/val):          0.057202
  训练RMSD (Å):                 0.2173
  验证RMSD (Å):                 0.3351  ⭐ 最佳
  成功率 (RMSD<0.5Å):           83.04%
  学习率:                       7.78e-06

────────────────────────────────────────────────────────────────────────────────
Epoch 42/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.021074
  验证损失 (Loss/val):          0.056484
  训练RMSD (Å):                 0.2155
  验证RMSD (Å):                 0.3333  
  成功率 (RMSD<0.5Å):           82.74%
  学习率:                       6.18e-06

────────────────────────────────────────────────────────────────────────────────
Epoch 43/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.020883
  验证损失 (Loss/val):          0.056983
  训练RMSD (Å):                 0.2143
  验证RMSD (Å):                 0.3348  
  成功率 (RMSD<0.5Å):           82.84%
  学习率:                       4.76e-06

────────────────────────────────────────────────────────────────────────────────
Epoch 44/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.020618
  验证损失 (Loss/val):          0.057024
  训练RMSD (Å):                 0.2134
  验证RMSD (Å):                 0.3349  
  成功率 (RMSD<0.5Å):           83.13%
  学习率:                       3.51e-06

────────────────────────────────────────────────────────────────────────────────
Epoch 45/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.020451
  验证损失 (Loss/val):          0.056530
  训练RMSD (Å):                 0.2123
  验证RMSD (Å):                 0.3335  
  成功率 (RMSD<0.5Å):           82.64%
  学习率:                       2.45e-06

────────────────────────────────────────────────────────────────────────────────
Epoch 46/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.020376
  验证损失 (Loss/val):          0.056840
  训练RMSD (Å):                 0.2120
  验证RMSD (Å):                 0.3343  
  成功率 (RMSD<0.5Å):           82.94%
  学习率:                       1.57e-06

────────────────────────────────────────────────────────────────────────────────
Epoch 47/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.020334
  验证损失 (Loss/val):          0.056899
  训练RMSD (Å):                 0.2116
  验证RMSD (Å):                 0.3345  ⭐ 最佳
  成功率 (RMSD<0.5Å):           82.64%
  学习率:                       8.86e-07

────────────────────────────────────────────────────────────────────────────────
Epoch 48/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.020277
  验证损失 (Loss/val):          0.056811
  训练RMSD (Å):                 0.2116
  验证RMSD (Å):                 0.3342  
  成功率 (RMSD<0.5Å):           82.94%
  学习率:                       3.94e-07

────────────────────────────────────────────────────────────────────────────────
Epoch 49/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.020162
  验证损失 (Loss/val):          0.056854
  训练RMSD (Å):                 0.2112
  验证RMSD (Å):                 0.3343  
  成功率 (RMSD<0.5Å):           82.84%
  学习率:                       9.87e-08

────────────────────────────────────────────────────────────────────────────────
Epoch 50/50
────────────────────────────────────────────────────────────────────────────────
  训练损失 (Loss/train):        0.020130
  验证损失 (Loss/val):          0.056882
  训练RMSD (Å):                 0.2107
  验证RMSD (Å):                 0.3344  
  成功率 (RMSD<0.5Å):           82.84%
  学习率:                       0.00e+00


================================================================================
📊 训练总结
================================================================================

✅ 训练完成: 50/50 epochs
✅ 最佳验证RMSD: 0.3333 Å (Epoch 42)

📉 RMSD下降趋势:
--------------------------------------------------------------------------------
  初始 (Epoch 1):              0.3993 Å
  25% (Epoch 12):            0.3448 Å
  50% (Epoch 25):            0.3363 Å
  75% (Epoch 37):            0.3355 Å
  最终 (Epoch 50):           0.3344 Å

  总改善: 0.0661 Å (16.5% 降低)

================================================================================
✅ 训练成功完成！
================================================================================
